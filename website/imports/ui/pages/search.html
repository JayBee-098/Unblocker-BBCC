<template name="pages_search">
  <div class="container">

    <div class="card">
      <div class="card-body">
        {{#autoForm schema='Schemas.Search' id='animeSearchFormQuery' autosave=true autosaveOnKeyup=true preserveForm=false}}
          {{> afQuickField name='query' value=searchOptions.query}}
        {{/autoForm}}
      </div>
    </div>

    <div class="card">
      <div class="card-header collapsed btn-unstyled btn-collapse" data-toggle="collapse" data-target="#animeSearchFormOptionsCollapse" aria-expanded="false" aria-controls="animeSearchFormOptionsCollapse">
        <i class="fas fa-caret-right"></i>
        More Search Options
      </div>
      <div class="card-body collapse" id="animeSearchFormOptionsCollapse">
        {{#autoForm schema='Schemas.Search' id='animeSearchFormOptions' autosave=true autosaveOnKeyup=true preserveForm=false}}
          {{> afQuickField name='types' value=searchOptions.types}}
          {{> afQuickField name='includeTypes' value=searchOptions.includeTypes}}
          {{> afQuickField name='genres' value=searchOptions.genres}}
          {{> afQuickField name='includeGenres' value=searchOptions.includeGenres}}
          <div class="row mb">
            <div class="col-auto">
              <button type="button" class="btn btn-primary btn-prev-season h-100">
                <i class="fas fa-chevron-left"></i>
                <span class="sr-only">Previous Season</span>
              </button>
            </div>
            <div class="col">
              <div class="row">
                <div class="col-sm">
                  {{> afQuickField name='season' value=searchOptions.season}}
                </div>
                <div class="col-sm">
                  {{> afQuickField name='year' value=searchOptions.year}}
                </div>
              </div>
            </div>
            <div class="col-auto">
              <button type="button" class="btn btn-primary btn-next-season h-100">
                <i class="fas fa-chevron-right"></i>
                <span class="sr-only">Next Season</span>
              </button>
            </div>
          </div>
          <button type="button" class="btn btn-primary" id="animeSearchFormOptionsReset">Reset</button>
        {{/autoForm}}
      </div>
    </div>

    <div class="card card-result-container">
      <div class="card-body">
        {{#each show in shows}}

          <a class="card card-show-item" href="{{pathFor 'show' showId=show._id}}">
            {{>components_image src=show.thumbnailUrls.[0] caption=show.name class="card-img-top"}}
            <div class="card-img-info">
              <div class="card-img-info-left">
                {{$dot show.availableEpisodes ($getStorageItem 'SelectedTranslationType')}}
                {{#if $exists show.episodeCount}}
                  / {{show.episodeCount}}
                {{/if}}
                <abbr title="episodes">eps</abbr>
              </div>
              {{#if show.season}}
                <div class="card-img-info-right">
                  {{displaySeason show.season}}
                </div>
              {{/if}}
            </div>
            <div class="card-body d-flex align-items-center">
              <p class="card-text text-center w-100">{{show.name}}</p>
            </div>
          </a>

        {{else unless showsLoading}}
          <div class="alert alert-info text-center w-100" role="alert">
            No Results Found
          </div>
        {{/each}}

        <div class="alert alert-info text-center w-100 {{#unless showsLoading}}removed{{/unless}}" role="alert" id="load-more-results">
          <div class="progress">
            <div class="progress-bar progress-bar-striped progress-bar-animated w-100" role="progressbar"></div>
          </div>
          Loading More Results ...
        </div>

      </div>
    </div>

  </div>
</template>
